# AWB是什么？

AWB（Auto White Balance）即自动白平衡。</br>
我还是那束光，飞过了Lens，飞过了Shutter，终于到了传感器，可它们非说我不纯！

## 白平衡

### 白光

白平衡，字面上的理解就是对白颜色的平衡。那又怎么定义白色呢？

我们在"[Camera 02-光](https://github.com/lowkeyway/Embedded/blob/master/Software/Driver/Camera/Camera%2002-%E5%85%89.md)"这一节中已经提到过光的本质，以及何为可见光。

<img src="https://github.com/lowkeyway/Embedded/blob/master/Software/Driver/Pic/Camera/Camera%20%E5%85%89%E6%98%AF%E4%BB%80%E4%B9%88.jpg">

所以白光就应该是混合了430nm ~ 790nm波长的所有的光。

至于为什么是这一段波长混合成的光才能称为白光呢？因为这是太阳光的长期对地球的驯化的结果：

<img src="https://github.com/lowkeyway/Embedded/blob/master/Software/Driver/Pic/Camera/Camera%2005-AWB%20%E5%A4%AA%E9%98%B3%E5%85%89%E7%9A%84%E5%85%89%E8%B0%B1.png">

看到没，人眼之所以能够看到430nm ~ 790nm这段波长的光，就是因为太阳光在这段光谱中的能量最大。

### 平衡

我们知道了，人类可见的太阳光就是白光（透明光），那么物体之所以呈现不同的颜色是因为他们不能够吸收这段波谱的光反射的结果。
所以，我们看到的白色的物体就是反射所有频段波谱光的结果，绿色的物体就是不能吸收绿色而反射绿光的结果，黑色的物体就是把所有的频段的光都吸收了。

但是，问题是，并不是所有的光源都跟太阳光一样包含了相同的波谱，并且占了相同的比例。所以，理论上，同一件白色的物体，放在不同的光源下的显示应该是呈现出不同的颜色的。
不过我们用经验告诉我们，一张白纸在阳关下是白的，在烛光下也是白的啊，没觉得会变成黄色或其他彩色啊？这是因为我们的人眼自带白平衡功能，相比之下，照相机的光传感器就更能真实反馈这种差别了：

<img src="https://github.com/lowkeyway/Embedded/blob/master/Software/Driver/Pic/Camera/Camera%2005-AWB%20%E7%99%BD%E5%B9%B3%E8%A1%A1%20%E5%90%8C%E4%B8%80%E7%89%A9%E4%BD%93%E5%9C%A8%E4%B8%8D%E5%90%8C%E5%85%89%E7%BA%BF%E4%B8%8B%E7%9A%84%E9%A2%9C%E8%89%B2.png">

从上图可见，白炽灯整张图片偏黄，荧光灯整张图片偏蓝。
相机好无辜，明明是客观反应了真实世界，却要来迎合人类的视觉系统，给自己强制加入白平衡的功能。
所以，平衡的意思就是把感光Sensor中的颜色转成人眼认为的颜色。

通常我们以白色为标准，即要求把感光Sensor中的白色转成人眼中的白色（相同的，整张其他颜色也会跟着变化），这个过程就叫做白平衡。


# AWB调节的是什么？

要想了解白平衡平衡的是什么，就要先知道为什么如白炽灯、荧光灯发出的光到底差别在哪里。

## 色温

色温，是表示光线中包含颜色成分的一个计量单位。直观的理解就是颜色的温度。不用诧异，就是我们能感知的这个温度。看它的计量单位就知道了-“K”（开尔文）。

### 光和温度的关系

我们知道，光是物体辐射时发出来的一份一份的能量。每一份能量可以称为一个光子，每个光子有自己的频率。如果这个频率敲好在可见光的范围内，就可以被人眼捕获、感知。


# AWB如何调节？

